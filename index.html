<!DOCTYPE html>
<html lang="az">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aylıq Xərc Tətbiqi</title>
<style>
  * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: Arial, sans-serif;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
}
html {
  scroll-behavior: smooth;
}
/* WebKit scrollbar stilleri */
::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}

::-webkit-scrollbar-track {
  background-color: #003333;
  border-radius: 10px;
}
body.dark-mode ::-webkit-scrollbar-track {
  background-color: transparent;
}
::-webkit-scrollbar-thumb {
  background-color: #00b3b3;
  border-radius: 10px;
  border: 3px solid #003333;
}
body.dark-mode ::-webkit-scrollbar-thumb {
  background-color: #003333;
  border: none;
}
::-webkit-scrollbar-thumb:hover {
  background-color: #008080;
}
/* Chrome, Safari, Edge için */
input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
#expenseChartHeader {
  padding-top: 2vh;
  text-align: center;
}
#expenseChart {
  margin-bottom: 50vh;
  width: 100%;
  height: 100vh;
  max-height: 100vh;
  backdrop-filter: blur(6px); /* Maksimum yükseklik sınırı belirleyin */
  cursor: pointer;
}
#addMoneySection {
  height: 100vh;
  padding-top: 2vh;
}
#moneyInfoSection {
  padding-top: 2vh;
  height: 100vh;
}
@media screen and (max-width: 768px) {
  #expenseChart {
    margin-bottom: 10vh;
    height: 40vh;
    max-height: 40vh;
  }
  .titleWeb {
    display: none;
  }
  #moneyInfoSection {
    height: 50vh;
  }
  #drag-drop-area {
    width: 30px;
    height: 30px;
  }
  #drop-message {
    display: none;
  }
}
/* Sayfa arka planı ve genel stiller */
body {
  background-color: #003333;
  color: #e0f7f7;
  font-size: 16px;
  line-height: 1.6;
  height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
/* Side Tabs */
#sideTabs {
  display: flex;
  flex-direction: column;
  gap: 2vh;
}
a {
  text-decoration: none;
  color: white;
  position: relative;
  font-size: 20px;
  transition: 0.5s ease;
  display: flex;
  gap: 5px;
  align-items: center;
}

a:hover {
  color: #00b3b3;
  border-bottom: 1px solid #00b3b3;
}
/* Giriş sayfası */
#login-page {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  background-color: #004d4d; /* Dark Cyan */
}

.login-container {
  background-color: #005757; /* Cyan Green */
  padding: 30px;
  border-radius: 8px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
  width: 100%;
  max-width: 400px;
}
h2 {
  color: #e0f7f7;
}

input,
select,
textarea {
  width: 100%;
  padding: 10px;
  margin-bottom: 15px;
  border: 1px solid #007373;
  border-radius: 30px;
  background-color: #003e3e;
  color: #e0f7f7;
  font-size: 14px;
  resize: none;
}
input:hover,
select:hover,
textarea:hover {
  border-color: #13bdbd;
}

input[type="password"],
input[type="text"],
input[type="number"],
select {
  transition: all 0.3s ease;
}

input[type="password"]:focus,
input[type="text"]:focus,
input[type="number"]:focus,
select:focus {
  border-color: #00b3b3;
  outline: none;
}
#apply-filters {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 40px;
  height: 40px;
  font-size: 20px;
}
.pagination-button {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 40px;
  height: 40px;
  font-size: 24px;
}
button {
  padding: 12px;
  background-color: #004d4d;
  border: none;
  border-radius: 30px;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  margin-bottom: 5px;
  display: flex;
  justify-content: center;
  align-items: center;
}

button:hover {
  background-color: #009999;
}

button:active {
  background-color: #007373;
}
#expenseForm {
  margin-bottom: 10px;
}
.import-export {
  backdrop-filter: blur(6px);
  border: 2px solid gray;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  padding: 30px;
  width: 100%;
  display: flex;
  justify-content: space-between;
}

.import-area,
.export-area {
  margin-bottom: 30px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.import-export h3 {
  font-size: 18px;
  color: #333;
  margin-bottom: 10px;
}

.import-export #drag-drop-area {
  border: 2px dashed #888;
  padding: 40px;
  width: 20vw;
  margin-bottom: 15px;
  background-color: rgba(255, 255, 255, 0.063);
  backdrop-filter: blur(5px);
  transition: all 0.5s ease;
}

.import-export #drag-drop-area:hover {
  border-color: #555;
  background-color: rgba(255, 255, 255, 0.388);
}

.import-export #drop-message {
  color: #666;
  font-size: 14px;
}

.import-export input[type="file"] {
  display: none;
}

@media screen and (max-width: 768px) {
  .import-export #drag-drop-area {
    background-color: transparent;
    border: none;
    margin: 0;
    padding: 0;
  }
  .import-export input[type="file"] {
    display: block;
    width: 60px;
  }
}
#importBtn {
  width: 3vw;
  height: 3vw;
  background-color: #00b3b3;
  color: #333;
  border: 1px solid #ccc;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  display: flex;
  justify-content: center;
  align-items: center;
}

#importBtn:disabled {
  background-color: #00b3b3;
  cursor: not-allowed;
}

#importBtn:hover:not(:disabled) {
  background-color: #009999;
}

.import-export .export-area button:hover {
  background-color: #009999;
}
#exportBtn {
  background-color: #00b3b3;
  width: 3vw;
  height: 3vw;
  border: none;
  border-radius: 30px;
  color: #fff;
  font-size: 22px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  text-align: center;
  display: flex;
  justify-content: center;
  align-items: center;
}
#exportBtn:hover {
  background-color: #009999;
}

#exportBtn:active {
  background-color: #007373;
}
@media screen and (max-width: 768px) {
  #exportBtn {
    font-size: 20px;
    font-weight: 700;
    width: 10vw;
    height: 10vw;
  }
  #importBtn {
    font-size: 20px;
    width: 10vw;
    height: 10vw;
  }
  .import-area {
    gap: 2vh;
  }
}
/* Dashboard */
#dashboard {
  width: 90%;
  height: 100%;
  padding: 20px;
  overflow: auto;
  position: relative;
}
.flex-Container {
  display: flex;
  justify-content: space-between;
  height: 100%;
  width: 100%;

  background-color: #003333;
}
body.dark-mode .flex-Container {
  background-color: #009999;
}
/* header start */
#header {
  background-color: #0b5c5c;
  color: white;
  padding: 10px;
  height: 100%;
  width: 15%;
  top: 0;
  left: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  justify-content: space-between;
  transition: 0.5s;
  border-top-right-radius: 30px;
  border-bottom-right-radius: 30px;
}

/* Profil kısmı */
.profile-flex {
  display: flex;
  flex-direction: column;
  align-items: center;
}
hr {
  width: 100%;
  padding: 0;
  margin: 0;
}
#profile-icon {
  margin-bottom: 10px;
  width: 80px;
  transition: 0.5s;
}
#profile-bio {
  display: flex;
  flex-wrap: wrap;
  gap: 3px;
  font-weight: 400;
  font-size: 20px;
}
#profile-image {
  width: 100%;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid white;
  margin-top: 5px;
}

#profile-fullname {
  font-weight: bold;
}

/* Çıkış butonu */
.logoutBtnSec {
  display: flex;
  gap: 6px;
}
#logoutBtn {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 30px;
  height: 30px;
  background-color: red;
  border: none;
  color: white;
  font-size: 24px;
  text-align: center;
}
#logoutLbl {
  font-size: 18px;
}
#logoutBtn i {
  font-size: 18px;
}
#logoutBtn:hover {
  background-color: #d32f2f;
}
/* Balance */
#balance{
  margin-bottom: 5px;
}
#balance-container {
  position: relative;
  transition: 1s;
}
#balance-container #addBalanceBtn {
  width: 20px;
  height: 20px;
  position: absolute;
  right: 5px;
  top: 45px;
  z-index: 1;
  transition: 1s;
}
#addAmount{
  width: 10vw;
}
/* OpenClose Arrow */
#openCloseArrow {
  position: absolute;
  top: 50%;
  right: -20px;
  background-color: #003333;
  border-radius: 30px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  width: 40px;
  height: 40px;
  font-size: 25px;
  transition: 0.001s;
  cursor: pointer;
  z-index: 9;
}

#openCloseArrow:hover i {
  transition: 0.5s;
  color: #00b3b3;
}
@media screen and (max-width: 768px) {
  #openCloseArrow {
    right: 25px;
    bottom: -40px;
    transform: rotate(90deg);
    padding: 15px;
    text-align: center;
  }
  #filter-day {
    width: 30vw;
  }
}
/* Profil Sayfası */
#profile-page {
  backdrop-filter: blur(10px);
  background-color: transparent;
  color: #ecf0f1;
  font-family: Arial, sans-serif;
  padding: 20px;
  border-radius: 8px;
  width: 100%;
  margin: 0 auto;
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  z-index: 1000;
  height: 100%;
}

#profile-page #avatar {
  display: none;
}
#closeWin {
  background-color: #ff4c4c;
  font-size: 15px;
}
#closeWin:hover {
  background-color: #e60000;
}
/* Harcama Sayfası */
#expenses-page {
  padding: 20px;
}
#expenseTable thead tr th:first-child {
  width: 10px;
}
.pag-filt {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
#expense-filters {
  display: flex;
  gap: 3px;
}
#filter-day {
  width: 10vw;
}
#pagination {
  display: flex;
  gap: 5px;
}
i {
  color: white;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  position: relative;
}

th,
td {
  padding: 12px;
  text-align: left;
  border: 1px solid #007373;
}

th {
  background-color: #004d4d;
}

td {
  background-color: #003e3e;
}

tr:nth-child(even) {
  background-color: #004d4d;
}
@media screen and (max-width: 768px) {
  table {
    font-size: 14px;
    overflow-x: auto;
    display: block;
    white-space: nowrap;
  }

  th,
  td {
    padding: 8px;
    transition: 0.5s;
  }
  #pagination {
    width: 30px;
    height: 30px;
    padding: 0;
    text-align: center;
    font-size: 12px;
  }
  .pag-filt {
    align-items: flex-start;
  }

  #expense-filters {
    gap: 5px;
  }

  #expense-filters input {
    font-size: 14px;
    width: 20vw;
  }

  #apply-filters {
    font-size: 14px;
    padding: 6px 10px;
  }
}

#avatar img {
  width: 50px;
  height: 50px;
  border-radius: 50%;
}

/* Responsive Tasarım */
@media (max-width: 768px) {
  #header {
    position: fixed;
    z-index: 9999;
  }
  .flex-Container {
    flex-direction: column;
  }
  #header {
    flex-direction: row;
    width: 100%;
    height: 20vw;
    border-top-right-radius: 0;
    border-bottom-left-radius: 30px;
    border-bottom-right-radius: 30px;
  }
  #sideTabs {
    display: none;
  }
  #profile-icon {
    width: 50px;
    margin: 0;
  }
  .profile-flex {
    flex-direction: row;
    gap: 6px;
    margin: 0;
  }
  #logoutBtn {
    left: 5px;
    width: 20px;
    font-size: 10px;
  }
  .login-container,
  #dashboard {
    padding: 15px;
    width: 100%;
  }

  table th,
  table td {
    font-size: 14px;
    padding: 10px;
  }
  #fileInput {
    width: 20vw;
    font-size: 10px;
    padding-right: 8px;
  }
}


/* Dark light */
#darklightButton {
  position: absolute;
  bottom: 15px;
  right: 15px;
  z-index: 10000;
  color: white;
  border: none;
  cursor: pointer;
  width: 30px;
  height: 30px;
  padding: 0;
}
#darklightButton i {
  font-size: 15px;
}
/* Currency */
.online-currency{
  gap: 1vw;
  position: fixed;
  top: 5px;
  right: 15px;
  z-index: 1000000;
  border-radius: 30px;
  backdrop-filter: blur(10px);
  padding: 10px;
  box-sizing: border-box;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
}
.currency span {
  font-weight: bold;
  color: lightcoral;
  animation: blink 1.5s infinite alternate;
}


.currency p{
  display: flex;
  gap: 1vw;
}
@keyframes blink {
  0% {
      opacity: 0.5;
  }
  100% {
      opacity: 1;
  }
}

.Logo-JPG{
  width: 4vw;
}
/* /* Modal Arxa Planı */
.modal {
  display: none; /* Başlanğıcda gizli */
  position: absolute;
  z-index: 1;
  right: 20px;
  top:  17vh;
  animation: fadeIn 0.3s ease-in-out;
  width: 15vw;
  height: 30vh;
}

/* Xəta Modalı */
.error-modal .modal-content {
  background-color: #f44336; /* Qırmızı arxa plan (Xəta) */
  color: white;
}

/* Bildiriş Modalı */
.notification-modal .modal-content {
  background-color: #4caf50; /* Yaşıl arxa plan (Bildiriş) */
  color: white;
}
/* Modalların başlanğıc vəziyyəti */
#notificationModal, #errorModal {
  display: none;
  opacity: 0;
  transition: opacity 0.5s ease;
}
/* Modal İçerik */
.modal-content {
  border-radius: 10px;
  text-align: center;
  animation: slideIn 0.5s ease-out;
}
.modal-content h2{
  font-size: 18px;
}
/* Animasiya */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideIn {
  from {
    transform: translateY(-50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
} */
/* Koyu Mod */
body.dark-mode {
  background-color: #00b3b3;
  color: white;
  transition: 0.5s;
}

/* Formlar ve inputlar */
body.dark-mode input,
body.dark-mode select,
body.dark-mode textarea,
body.dark-mode button {
  background-color: #009999;
  color: white;
  border: 1px solid white;
  transition: 0.5s ease-in-out;
}
body.dark-mode #header {
  background-color: #08b8b880;
}
body.dark-mode #openCloseArrow {
  background-color: #009999;
}

body.dark-mode input::placeholder,
body.dark-mode select::placeholder,
body.dark-mode textarea::placeholder {
  color: white; /* Placeholder rengi beyaz-kahverengi olur */
  transition: 0.5s ease-in-out;
}
/* a tag */
body.dark-mode a:hover {
  color: gray;
}
/* Başlıklar */
body.dark-mode h1,
body.dark-mode h2,
body.dark-mode h3,
body.dark-mode h4,
body.dark-mode h5,
body.dark-mode h6 {
  color: white;
  transition: 0.5s ease-in-out;
}

/* Tablo Başlıkları ve Hücreler */
body.dark-mode th,
body.dark-mode td {
  border: 1px solid white;
  transition: 0.5s ease-in-out;
}

body.dark-mode table {
  background-color: #009999;
  transition: 0.5s ease-in-out;
}

/* Profil ve Dashboard Sayfaları */
body.dark-mode #profile-icon img,
body.dark-mode #profile-image {
  border-color: red;
  transition: 0.5s ease-in-out;
}

/* Butonlar */
body.dark-mode button {
  background-color: white;
  color: #006666;
  border: none;
  cursor: pointer;
  transition: 0.5s ease-in-out;
}
body.dark-mode i {
  color: #006666;
}
body.dark-mode button:hover {
  background-color: rgba(255, 255, 255, 0.586);
  transition: 0.5s ease-in-out;
}
th:hover,
td:hover {
  background-color: #058787;
  color: white;
  cursor: pointer;
}

/* Sayfa başlıkları ve metin */
body.dark-mode #expenseTable th {
  background-color: #0e8888;
  transition: 0.5s ease-in-out;
}
body.dark-mode #expense-filters,
body.dark-mode #expenseTable td,
body.dark-mode .import-area,
body.dark-mode .export-area {
  background-color: #009999;
  color: inherit;
  transition: 0.5s ease-in-out;
}
body.dark-mode th:hover,
body.dark-mode td:hover {
  background-color: gray;
}
/* Filtre ve Arama Alanları */
body.dark-mode input[type="date"],
body.dark-mode input[type="number"],
body.dark-mode textarea {
  background-color: #009999;
  color: white;
  transition: 0.5s ease-in-out;
}

/* Sayfa geçişi ve diğer alanlar */
body.dark-mode #login-page,
body.dark-mode {
  background-color: #009999;
  color: white;
  transition: 0.5s ease-in-out;
}

body.dark-mode #darklightButton {
  background-color: #006666;
  color: white;
  transition: 0.5s ease-in-out;
}
body.dark-mode #darklightButton i {
  color: white;
}
body.dark-mode #pagination {
  color: white;
  transition: 0.5s ease-in-out;
}

body.dark-mode #expense-filters {
  color: white;
  transition: 0.5s ease-in-out;
}

body.dark-mode #expenseChart {
  transition: 0.5s ease-in-out;
}


</style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  </head>
  <body>
    <!-- Giriş Səhifəsi -->
    <div id="login-page">
      <div class="login-container">
        <h2>İstifadəçi Girişi</h2>
        <form id="loginForm">
          <input
            type="text"
            id="username"
            placeholder="İstifadəçi Adı"
            required
          />
          <input type="password" id="password" placeholder="Şifrə" required />
          <button type="submit"><i class="fas fa-sign-in"></i></button>
        </form>
      </div>
    </div>
    <button id="darklightButton"><i class="darkicon" ><i class="fas fa-moon darkicon"></i></i><i class="lighticon"><i class="fas fa-sun lighticon hidden"></i></i></button>

<div class="flex-Container" id="flex-Container" style="display: none;">
<!-- Sidebar -->
    <div id="header">
      <div class="profile-flex">
      <div id="profile-icon">
        <img id="profile-image" src="" alt="Profil Şəkli" />
      </div>
      <div id="profile-bio">
        <div id="profile-fullname"></div>
        <hr>
         <!-- Balansın göstərilməsi -->
  <div id="balance-container">
    <p id="balance"><i class="fa-solid fa-wallet"></i> 0 ₼</p>
    <button id="addBalanceBtn"><i class="fas fa-arrow-up"></i></i></button>
    <input type="number" id="addAmount" placeholder="Balans miqdarı" min="0" step="0.01">
  </div>
      </div>
    </div>
  
    <div id="sideTabs">
      <a href="#expenseChartHeader" class="tabLink"><i class="fas fa-home"></i><p class="hiddenTxt">Əsas</p></a>
      <a href="#addMoneySection" class="tabLink"><i class="fas fa-money-bill-wave"></i><p class="hiddenTxt">Xərc əlavə et</p></a>
      <a href="#moneyInfoSection" class="tabLink"><i class="fas fa-info-circle"></i><p class="hiddenTxt">Xərc məlumatları</p></a>
      <a href="#about" class="tabLink"><i class="fas fa-question-circle"></i><p class="hiddenTxt">Haqqımızda</p></a>
    </div>
      
      <button id="openCloseArrow">
        <i class="fa-solid fa-chevron-left"></i>
      </button> 
      <div class="logoutBtnSec">
      <label for="logoutBtn" id="logoutLbl">Çıxış</label>
      <button id="logoutBtn"><i class="fas fa-sign-out"></i></button>
    </div>
    <img src="https://i.ibb.co/3kDXQMm/orig.png" alt="Logo" class="Logo-JPG" title="Logo ExpenseSF">
    </div>

    <!-- Dashboard Səhifəsi -->
    <div id="dashboard">
      <h2 id="expenseChartHeader">Xərc Statistikası</h2>
      <canvas id="expenseChart" class="tabContent">
      </canvas>
      <!-- Profil Səhifəsi -->
      <div id="profile-page">
        <h2>Profil Məlumatları</h2>
        <form id="profileForm">
          <input type="text" id="name" placeholder="Ad" required />
          <input type="text" id="surname" placeholder="Soyad" required />
          <input type="date" id="dob" placeholder="Doğum Günü" required />
          <select id="gender" required>
            <option value="">Cinsiyyət</option>
            <option value="male">Kişi</option>
            <option value="female">Qadın</option>
          </select>
          <div id="avatar" style="display: none"></div>
          <button type="submit" id="save-btns"><i class="fas fa-save"></i></button>
        </form>
        <button id="closeWin"><i class="fa fa-close" style="font-size:20px"></i></i></button>
      </div>

      <!-- Xərc Səhifəsi -->
      <div id="expenses-page">
        <div id="addMoneySection" class="tabContent">
        <h2>Xərc əlavə et</h2>
        <form id="expenseForm">
          <select id="category" required>
            <option value="">Kateqoriya Seçin</option>
            <option value="qida">Yemək</option>
            <option value="nəqliyyat">Nəqliyyat</option>
            <option value="əyləncə">Əyləncə</option>
            <option value="geyim">Geyim</option>
            <option value="tibb">Sağlamlıq</option>
            <option value="təhsil">Təhsil</option>
            <option value="infrastruktur">İnfrastruktur</option>
            <option value="səyahət">Səyahət</option>
          </select>
          <input type="number" id="amount" placeholder="Məbləğ" required step="0.01" />
          <textarea id="description" placeholder="Təsvir"></textarea>
          <select id="currency" required>
            <option value="AZN">₼</option>
            <option value="USD">$</option>
            <option value="EUR">€</option>
          </select>
          <button type="submit">Yadda Saxla</button>
        </form>
        <div class="import-export" id="import-export" class="tabContent">
          <div class="import-area">
            <div id="drag-drop-area" class="drag-drop-area">
              <p id="drop-message">Bura sürükləyin və ya klikləyin.</p>
              <input type="file" id="fileInput" accept=".xlsx, .xls" />
            </div>
            <button id="importBtn" disabled><i class="fa fa-upload"></i></button>
          </div>
      <div class="export-area">
        <button id="exportBtn"><i class="fa fa-file-excel"></i></button>
      </div>
      </div>
      </div>
      <div id="moneyInfoSection" class="tabContent">
        <h3>Xərc Məlumatları</h3>
        <table id="expenseTable">
          <thead>
            <tr>
              <th>№</th>
              <th>Kateqoriya</th>
              <th>Məbləğ</th>
              <th>Təsvir</th>
              <th>Valyuta</th>
              <th>Tarix</th>
            </tr>
          </thead>
          <div class="pag-filt">
          <div id="pagination">
            <!-- Səhifə nömrələri buraya əlavə ediləcək -->
          </div>
          <div id="expense-filters">
            <input type="date" id="filter-day">
            <button id="apply-filters"><i class="fas fa-search"></i></button>
          </div>
        </div>
          <tbody>
            <!-- Xərclər buraya əlavə ediləcək -->
          </tbody>
        </table>
      </div>
      </div>
      <!-- Valyuta -->
      <div class="online-currency" title="Onlayn valyuta">
        <div class="currency">
            <p>₼: <span id="azn">Yüklənir...</span></p>
        </div>
        <div class="currency">
            <p>$: <span id="usd">Yüklənir...</span></p>
        </div>
        <div class="currency">
            <p>₽: <span id="rub">Yüklənir...</span></p>
      </div>
    </div>

    </div>
  </div>
   <!-- Xəta Modalı -->
   <div id="errorModal" class="modal error-modal">
    <div class="modal-content">
      <span class="close-btn"></span>
      <h2>Xəta!</h2>
      <p id="errorMessage">Bir xəta baş verdi!</p>
    </div>
  </div>

  <!-- Bildiriş Modalı -->
  <div id="notificationModal" class="modal notification-modal">
    <div class="modal-content">
      <h2>Bildiriş</h2>
      <p id="notificationMessage">Bir bildiriş mesajı!</p>
    </div>
  </div>

    <script type="module" >
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
import { getDatabase, ref, set, push, get, child, remove } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js";


// Firebase konfiqurasiyası
const firebaseConfig = {
  apiKey: "AIzaSyAse2CQeXYNiZM6Kt7V9ouVOuEQlTLVtpg",
  authDomain: "economic-49b56.firebaseapp.com",
  projectId: "economic-49b56",
  storageBucket: "economic-49b56.firebasestorage.app",
  messagingSenderId: "175566342258",
  appId: "1:175566342258:web:0bfcf53a613767963ddaeb"
};

// Firebase başlatma
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// İstifadəçi girişi
const loginForm = document.getElementById('loginForm');
loginForm.addEventListener('submit', async (e) => {
  e.preventDefault();

  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;

  // GitHub-dan istifadəçi doğrulama (nümunə məlumat)
  const res = await fetch('https://raw.githubusercontent.com/ferhadsultan98/infos/main/pass.json');
  const data = await res.json();

  const user = data.userCredentials.find(u => u.username === username && u.password === password);
  if (user) {
    localStorage.setItem('username', username); // Giriş etdikdən sonra istifadəçini localStorage-a qeyd edək
    document.getElementById('login-page').style.display = 'none';
    document.getElementById('flex-Container').style.display = 'flex';
    loadProfile(username);
  } else {
    showErrorModal('İstifadəçi adı və ya şifrə yanlışdır');
  }
  updateExpenseTable();  // Cədvəli yeniləyirik
  updateExpenseStatistics() // Statistikaları yeniləyirik
  getBalance() // Məbləği yeniləmək
});

// Sayfa yükləndikdə istifadəçi giriş vəziyyəti yoxlanılsın
window.onload = () => {
  const username = localStorage.getItem('username');
  if (username) {
    document.getElementById('login-page').style.display = 'none';
    document.getElementById('flex-Container').style.display = 'flex';
    loadProfile(username);
  }
};

// Çıxış et
document.getElementById('logoutBtn').addEventListener('click', () => {
  localStorage.removeItem('username');
  document.getElementById('login-page').style.display = 'flex';
  document.getElementById('flex-Container').style.display = 'none';
});

// Profil məlumatlarını yüklə
async function loadProfile(username) {
  const profileRef = ref(db, 'profiles/' + username);
  const snapshot = await get(profileRef);

  if (snapshot.exists()) {
    const profile = snapshot.val();
    document.getElementById('name').value = profile.name;
    document.getElementById('surname').value = profile.surname;
    document.getElementById('dob').value = profile.dob;
    document.getElementById('gender').value = profile.gender;

    const avatar = document.getElementById('avatar');
    avatar.innerHTML = `<img src="${profile.avatar}" alt="Avatar">`;
    const profileFullname = document.getElementById("profile-fullname")
    profileFullname.innerHTML = document.getElementById('name').value + ' ' + document.getElementById('surname').value;

    // Profil ikonunu göstər
    document.getElementById('profile-icon').style.display = 'block';
    document.getElementById('profile-image').src = profile.avatar;
  }
}

// Profilı yadda saxla
const profileForm = document.getElementById('profileForm');
profileForm.addEventListener('submit', (e) => {
  e.preventDefault();

  const username = localStorage.getItem('username');
  const name = document.getElementById('name').value;
  const surname = document.getElementById('surname').value;
  const dob = document.getElementById('dob').value;
  const gender = document.getElementById('gender').value;
  const avatar = gender === 'male' ? 'https://randomuser.me/api/portraits/men/1.jpg' : 'https://randomuser.me/api/portraits/women/1.jpg';

  set(ref(db, 'profiles/' + username), {
    name,
    surname,
    dob,
    gender,
    avatar
  });

  showNotificationModal('Profil yadda saxlanıldı');

  // Profil ikonunu göstər
  document.getElementById('profile-icon').style.display = 'block';
  document.getElementById('profile-image').src = avatar;
});

// Sayfa yükləndikdə profil səhifəsi gizli olacaq
document.getElementById('profile-page').style.display = 'none';

// Profil ikonuna klikləmə hadisə dinləyicisi əlavə et
document.getElementById("profile-icon").addEventListener("click", function () {
  const profilePage = document.getElementById('profile-page');
  const closeWin = document.getElementById("closeWin")
  closeWin.addEventListener("click", function () {
    profilePage.style.display = 'none';
  })
  if (profilePage.style.display === 'block') {
    profilePage.classList.remove('show');
    setTimeout(() => {
      profilePage.style.display = 'none';
    }, 500);
  } else {
    profilePage.style.display = 'block';
    setTimeout(() => {
      profilePage.classList.add('show');
    }, 10);
  }
  // Xərc səhifəsini gizlət
  document.getElementById('expense-page').style.display = 'none';
});

// Balansı Firebase-dən götürmək və səhifədə göstərmək
async function getBalance() {
  const username = localStorage.getItem('username');
  const balanceRef = ref(db, 'balance/' + username);  // Firebase 9+ ref() ilə əlaqə qurulur

  try {
    const snapshot = await get(balanceRef);  // get() ilə verilənlər bazasından məlumat alınır
    const balance = snapshot.val();
    if (balance) {
      document.getElementById('balance').innerHTML = `<i class="fa-solid fa-wallet"></i> : ${balance.amount} ₼`;
    } else {
      document.getElementById('balance').innerHTML = `<i class="fa-solid fa-wallet"></i> : 0 ₼`;
    }

  } catch (error) {
    console.error('Balansı almaqda xəta baş verdi:', error);
  }
}


// Xərcləri Firebase-ə əlavə etmək və balansı yeniləmək
const expenseForm = document.getElementById('expenseForm');
expenseForm.addEventListener('submit', async (e) => {
  e.preventDefault();

  const category = document.getElementById('category').value;
  let amount = document.getElementById('amount').value;

  // Vergül və nöqtəni düzəltmək (dəqiqləşdiririk ki, hər ikisini də qəbul edək)
  amount = amount.replace(/,/g, '.');  // Vergülləri nöqtəyə çeviririk
  amount = parseFloat(amount);  // Məbləği rəqəmə çeviririk

  if (isNaN(amount)) {
    showErrorModal('Xərc məbləği düzgün daxil edilməyib.');
    return;
  }

  const description = document.getElementById('description').value;
  const currency = 'AZN';  // Əgər hər zaman AZN olarsa
  const username = localStorage.getItem('username');

  // 100000 AZN-dən çox xərc əlavə etməyə icazə verməmək
  if (amount > 100000) {
    showErrorModal('Xərc məbləği 100000 AZN-dən çox ola bilməz.');
    return;
  }

  // Xərci Firebase-ə əlavə et
  const expense = { category, amount, description, currency, date: new Date().toISOString() };
  const expensesRef = ref(db, 'expenses/' + username);  // Firebase 9+ ref() ilə əlaqə qurulur

  try {
    // Balansı əldə et və yoxla
    const balanceRef = ref(db, 'balance/' + username);
    const snapshot = await get(balanceRef);
    const currentBalance = snapshot.val()?.amount || 0;

    // Balansda kifayət qədər pul olmadıqda xəta mesajı
    if (currentBalance < amount) {
      showErrorModal('Balansınızda kifayət qədər pul yoxdur.');
      return;
    }

    // Xərci Firebase-ə əlavə et
    await push(expensesRef, expense);

    // Yeni balansı hesablamaq
    const newBalance = currentBalance - amount;

    // Yeni balansı Firebase-ə yaz
    await set(balanceRef, { amount: newBalance });

    // Bildirişin işarəsini yeniləyin
    showNotificationModal(`${category} sahəsində ${amount.toFixed(2)}₼ xərclənildi!`);
    getBalance();
    updateExpenseTable();

  } catch (error) {
    console.error('Xərc əlavə edilməsində xəta baş verdi:', error);
  }
});



// Balansı artırmaq üçün
const addBalanceBtn = document.getElementById('addBalanceBtn');
addBalanceBtn.addEventListener('click', async () => {
  // İstifadəçinin daxil etdiyi məbləği alıb, vergül və ya nöqtəni aradan qaldırırıq
  let addAmount = document.getElementById('addAmount').value;
  addAmount = addAmount.replace(/,/g, '.');  // Vergülləri nöqtəyə çeviririk
  addAmount = parseFloat(addAmount);  // Məbləği rəqəmə çeviririk

  if (isNaN(addAmount) || addAmount <= 0) {
    showNotificationModal('Zəhmət olmasa müsbət bir məbləğ daxil edin.');
    return;
  }

  // Məbləğ 100000 AZN-dən böyük olarsa, xəbərdarlıq göstər və funksiyanı dayandır
  if (addAmount > 100000) {
    showErrorModal('Məbləğ 100000 AZN-dən çox ola bilməz.');
    return;
  }

  const username = localStorage.getItem('username');
  const balanceRef = ref(db, 'balance/' + username);  // Firebase 9+ ref() ilə əlaqə qurulur

  try {
    const snapshot = await get(balanceRef);  // get() ilə verilənlər bazasından məlumat alınır
    const currentBalance = snapshot.val()?.amount || 0;
    const newBalance = currentBalance + addAmount;

    await set(balanceRef, { amount: newBalance });  // Yeni balansı Firebase-ə yaz
    // Yeni bildiriş yaradın

    showNotificationModal(`Balansınız ${addAmount} AZN artırıldı`);
    document.getElementById('addAmount').value = '';
    getBalance();  // Balansı yenilə
  } catch (error) {
    console.error('Balans artırılarkən xəta baş verdi:', error);
  }
});


// Sayfa yükləndikdə balansı və cədvəli yüklə
document.addEventListener('DOMContentLoaded', () => {
  getBalance();  // Səhifə yükləndikdə balansı alırıq
  updateExpenseTable();  // Cədvəli yeniləyirik

});

// Xərc cədvəlini yeniləmə
let currentPage = 1;
const itemsPerPage = 10;

async function updateExpenseTable() {
  const username = localStorage.getItem('username'); // İstifadəçi adını alırıq

  // Firebase URL üzərindən məlumatları əldə etmək üçün fetch istifadə edirik
  const url = `https://economic-49b56-default-rtdb.firebaseio.com/expenses/${username}.json`;

  try {
    // Məlumatı alırıq
    const response = await fetch(url);
    const expenses = await response.json();

    // Cədvəli seçirik
    const expenseTableBody = document.querySelector('#expenseTable tbody');
    const paginationContainer = document.querySelector('#pagination');

    // Cədvəli təmizləyirik
    expenseTableBody.innerHTML = '';

    if (expenses) {
      // Məlumatları siyahıya çevirib tarixə görə sıralayırıq
      const sortedExpenses = Object.values(expenses).sort((a, b) => {
        const dateA = new Date(a.date);
        const dateB = new Date(b.date);
        return dateB - dateA; // Böyükdən kiçiyə sıralama (yeni tarixlər yuxarıda olacaq)
      });

      // Səhifələr üçün ümumi sayı hesablayırıq
      const totalPages = Math.ceil(sortedExpenses.length / itemsPerPage);

      // Cari səhifədəki xərcləri alırıq
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const currentPageExpenses = sortedExpenses.slice(startIndex, endIndex);

      // Məlumatları işləyərək cədvələ əlavə edirik
      currentPageExpenses.forEach((expense, index) => {
        const row = document.createElement('tr');

        // Məlumatı sətirə əlavə edirik
        row.innerHTML = `
            <td>${startIndex + index + 1}</td> 
            <td>${expense.category}</td>
            <td>${expense.amount}</td>
            <td>${expense.description}</td>
            <td>${expense.currency}</td>
            <td>${new Date(expense.date).toLocaleString('az-AZ', {
          timeZone: 'Asia/Baku',
          day: '2-digit',
          month: '2-digit',
          year: 'numeric'
        })}</td>`;

        // Sətiri cədvələ əlavə edirik
        expenseTableBody.appendChild(row);
      });

      // Səhifələmə düymələrini yaradırıq
      paginationContainer.innerHTML = '';
      for (let i = 1; i <= totalPages; i++) {
        const pageButton = document.createElement('button');
        pageButton.textContent = i;
        pageButton.classList.add('pagination-button');
        pageButton.onclick = () => {
          currentPage = i;
          updateExpenseTable(); // Səhifə dəyişdikdə cədvəli yenilə
        };

        // Əgər bu cari səhifədirsə, düyməni aktiv et
        if (i === currentPage) {
          pageButton.disabled = true;
        }

        paginationContainer.appendChild(pageButton);
      }
    } else {
      // Əgər xərc məlumatı yoxdursa, bir məlumat mesajı göstərək
      const row = document.createElement('tr');
      row.innerHTML = `<td colspan="6">Hələlik xərc məlumatı yoxdur.</td>`;
      expenseTableBody.appendChild(row);
    }
  } catch (error) {
    console.error('Məlumat alınarkən bir xəta baş verdi:', error);
    // Xəta mesajı əlavə edək
    const expenseTableBody = document.querySelector('#expenseTable tbody');
    const row = document.createElement('tr');
    row.innerHTML = `<td colspan="6">Məlumat alınarkən bir xəta baş verdi. Zəhmət olmasa, yenidən cəhd edin.</td>`;
    expenseTableBody.appendChild(row);
  }
}

// Sayfa ilk açıldığında cədvəli yüklə
updateExpenseTable();


// Sayfa yükləndikdə xərclər cədvəlini yeniləmək
document.addEventListener('DOMContentLoaded', updateExpenseTable);

// İstifadəçi adı dəyişdikdə cədvəlin yenilənməsi üçün event listener əlavə edə bilərsiniz
document.getElementById('username').addEventListener('input', updateExpenseTable);

async function updateExpenseStatistics() {
  const username = localStorage.getItem('username'); // İstifadəçi adını alırıq

  const url = `https://economic-49b56-default-rtdb.firebaseio.com/expenses/${username}.json`;

  try {
    // Xərc məlumatlarını alırıq
    const response = await fetch(url);
    const expenses = await response.json();

    // Kateqoriyalara görə xərc cəm və sayı hesablayırıq
    const categoryTotals = {
      qida: { totalAmount: 0, count: 0 },
      nəqliyyat: { totalAmount: 0, count: 0 },
      əyləncə: { totalAmount: 0, count: 0 },
      geyim: { totalAmount: 0, count: 0 },
      tibb: { totalAmount: 0, count: 0 },
      təhsil: { totalAmount: 0, count: 0 },
      infrastruktur: { totalAmount: 0, count: 0 },
      səyahət: { totalAmount: 0, count: 0 }
    };

    if (expenses) {
      // Məlumatları işləyərək kateqoriyalara görə cəm xərc və sayları hesablayırıq
      Object.values(expenses).forEach(expense => {
        if (expense.category && categoryTotals[expense.category]) {
          categoryTotals[expense.category].totalAmount += parseFloat(expense.amount);
          categoryTotals[expense.category].count += 1;
        }
      });
    }

    // Qrafik məlumatlarını yaradırıq
    const chartData = {
      labels: ['Yemək', 'Nəqliyyat', 'Əyləncə', 'Geyim', 'Sağlamlıq', 'Təhsil', 'İnfrastruktur', 'Səyahət'],
      datasets: [
        {
          label: 'Toplam Xərc Miqdarı (Qiymət)',
          data: [
            categoryTotals.qida.totalAmount,
            categoryTotals.nəqliyyat.totalAmount,
            categoryTotals.əyləncə.totalAmount,
            categoryTotals.geyim.totalAmount,
            categoryTotals.tibb.totalAmount,
            categoryTotals.təhsil.totalAmount,
            categoryTotals.infrastruktur.totalAmount,
            categoryTotals.səyahət.totalAmount
          ],
          backgroundColor: 'rgba(255, 99, 132, 0.6)',
          borderColor: '#FF5733',
          borderWidth: 2,
          hoverBackgroundColor: 'rgba(255, 99, 132, 0.8)',
          hoverBorderColor: '#FF5733',
          hoverBorderWidth: 3,
          barPercentage: 0.35
        },
        {
          label: 'Xərc Sayı (Neçə Dəfə)',
          data: [
            categoryTotals.qida.count,
            categoryTotals.nəqliyyat.count,
            categoryTotals.əyləncə.count,
            categoryTotals.geyim.count,
            categoryTotals.tibb.count,
            categoryTotals.təhsil.count,
            categoryTotals.infrastruktur.count,
            categoryTotals.səyahət.count
          ],
          backgroundColor: 'rgba(75, 192, 192, 0.6)',
          borderColor: '#33FF57',
          borderWidth: 2,
          hoverBackgroundColor: 'rgba(75, 192, 192, 0.8)',
          hoverBorderColor: '#33FF57',
          hoverBorderWidth: 3,
          barPercentage: 0.35
        }
      ]
    };

    // Əgər əvvəllər yaradılmış bir qrafik varsa, onu silirik
    if (window.expenseChart instanceof Chart) {
      window.expenseChart.destroy();
    }

    let currentPage = 1;
    const itemsPerPage = 10;
    let expenseList = [];  // Xərclərin hamısı (filtrlənməmiş siyahı)

    // Xərclər cədvəlini yeniləyirik
    async function updateExpenseTable(filteredExpenses = []) {
      const username = localStorage.getItem('username');
      const url = `https://economic-49b56-default-rtdb.firebaseio.com/expenses/${username}.json`;

      try {
        const response = await fetch(url);
        const data = await response.json();

        // Firebase obyektini massivə çeviririk
        expenseList = data ? Object.values(data) : [];

        // Xərcləri sıralayırıq
        const sortedExpenses = expenseList.sort((a, b) => {
          const dateA = new Date(a.date);
          const dateB = new Date(b.date);
          return dateB - dateA; // Yeni tarixlər əvvəl gəlir
        });

        // Filtrə uyğun xərcləri seçirik
        const displayExpenses = filteredExpenses.length > 0 ? filteredExpenses : sortedExpenses;

        // Cədvəli yeniləyirik
        const expenseTableBody = document.querySelector('#expenseTable tbody');
        expenseTableBody.innerHTML = ''; // Cədvəli təmizləyirik

        // Səhifələmə üçün ümumi səhifə sayı
        const totalPages = Math.ceil(displayExpenses.length / itemsPerPage);

        // Cari səhifə və səhifələmə üçün başlanğıc və son indeksləri hesablayırıq
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const currentPageExpenses = displayExpenses.slice(startIndex, endIndex);

        // Xərcləri cədvələ əlavə edirik
        currentPageExpenses.forEach((expense, index) => {
          const row = document.createElement('tr');
          row.innerHTML = ` 
        <td>${startIndex + index + 1}</td> 
        <td>${expense.category}</td>
        <td>${expense.amount}</td>
        <td>${expense.description}</td>
        <td>${expense.currency}</td>
        <td>${new Date(expense.date).toLocaleString('az-AZ', {
            timeZone: 'Asia/Baku',
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
          })}</td>
      `;
          expenseTableBody.appendChild(row);
        });

        // Səhifələmə düymələrini yaratmaq
        const paginationContainer = document.querySelector('#pagination');
        paginationContainer.innerHTML = '';
        for (let i = 1; i <= totalPages; i++) {
          const pageButton = document.createElement('button');
          pageButton.textContent = i;
          pageButton.classList.add('pagination-button');
          pageButton.onclick = () => {
            currentPage = i;
            updateExpenseTable(filteredExpenses); // Filtrlə cədvəli yenilə
          };

          // Cari səhifəni aktiv et
          if (i === currentPage) {
            pageButton.disabled = true;
          }

          paginationContainer.appendChild(pageButton);
        }

        // Əgər heç bir xərc yoxdursa
        if (displayExpenses.length === 0) {
          const row = document.createElement('tr');
          row.innerHTML = `<td colspan="6">Hələ ki xərcləmə məlumatı yoxdur.</td>`;
          expenseTableBody.appendChild(row);
        }

      } catch (error) {
        console.error('Veri alınarkən xəta baş verdi:', error);
        const expenseTableBody = document.querySelector('#expenseTable tbody');
        const row = document.createElement('tr');
        row.innerHTML = `<td colspan="6">Veri alınarkən xəta baş verdi. Zəhmət olmasa təkrar cəhd edin.</td>`;
        expenseTableBody.appendChild(row);
      }
    }

    // Filtrləmə tətbiq edildikdə cədvəli yeniləyirik
    document.getElementById('apply-filters').addEventListener('click', () => {
      const day = document.getElementById('filter-day').value;

      // Filtrlənmiş xərcləri əldə edirik
      const filteredExpenses = expenseList.length > 0 ? expenseList.filter(expense => {
        const expenseDate = new Date(expense.date);

        if (day) {
          const selectedDay = new Date(day);
          return expenseDate.getDate() === selectedDay.getDate() &&
            expenseDate.getMonth() === selectedDay.getMonth() &&
            expenseDate.getFullYear() === selectedDay.getFullYear();
        }

        return true; // Filtr seçilməyibsə, bütün xərcləri göstəririk
      }) : [];

      // Filtrə uyğun cədvəli yenilə
      currentPage = 1; // Filtr tətbiq edildikdə səhifə yenidən 1-ci səhifəyə sıfırlanır
      updateExpenseTable(filteredExpenses);
    });

    // Başlanğıcda cədvəli yüklə
    updateExpenseTable();

    // Sayfa yükləndikdə cədvəli yeniləyirik
    document.addEventListener('DOMContentLoaded', () => {
      updateExpenseTable();  // Başlanğıcda bütün xərcləri göstəririk
    });

    // Canvas elementi üçün qrafik yaradırıq
    const ctx = document.getElementById('expenseChart').getContext('2d');

    // Yeni Chart yaradılır
    window.expenseChart = new Chart(ctx, {
      type: 'bar', // Bar chart növü
      data: chartData, // Dataset verilənləri
      options: {
        responsive: true, // Uyğun ölçüdə görünüş
        maintainAspectRatio: false, // Aspect ratio'yu korumadan boyutlandırma
        scales: {
          y: {
            beginAtZero: true, // Y oxu sıfırdan başlasın
            grid: {
              borderColor: 'rgba(255, 255, 255, 0.2)', // Y oxunun grid xətti rəngi
              borderWidth: 1,
              color: 'rgba(255, 255, 255, 0.1)', // Xəttin rəngi
            },
            ticks: {
              font: {
                size: 14, // Y oxu yazılarının ölçüsü
                family: 'Arial, sans-serif', // Yazı tipi
                weight: 'bold', // Yazının qalınlığı
                color: '#fff' // Yazı rəngi
              }
            }
          },
          x: {
            grid: {
              borderColor: 'rgba(255, 255, 255, 0.2)', // X oxunun grid xətti rəngi
              borderWidth: 1,
              color: 'rgba(255, 255, 255, 0.1)',
            },
            ticks: {
              font: {
                size: 14, // X oxu yazılarının ölçüsü
                family: 'Arial, sans-serif',
                weight: 'bold',
                color: '#fff' // Yazı rəngi
              }
            }
          }
        },
        plugins: {
          tooltip: {
            backgroundColor: 'rgba(0, 0, 0, 0.7)', // Tooltip fonu
            titleColor: '#fff', // Tooltip başlıq rəngi
            bodyColor: '#fff', // Tooltip bədən rəngi
            borderColor: 'rgba(255, 255, 255, 0.5)', // Tooltip sərhəd rəngi
            borderWidth: 1, // Tooltip sərhəd qalınlığı
            bodyFont: {
              size: 14, // Tooltip bədən yazı ölçüsü
              family: 'Arial, sans-serif',
              weight: 'bold',
            },
            titleFont: {
              size: 16, // Tooltip başlıq yazı ölçüsü
              family: 'Arial, sans-serif',
              weight: 'bold',
            },
            callbacks: {
              label: function (tooltipItem) {
                // Fərqli datasetlər üçün fərqli labellər
                const dataset = tooltipItem.datasetIndex;
                const dataValue = tooltipItem.raw;
                if (dataset === 0) {
                  // İlk dataset: Toplam Xərc Miqdarı
                  return 'Toplam Xərc Miqdarı (Qiymət): ' + dataValue + ' AZN';
                } else if (dataset === 1) {
                  // İkinci dataset: Xərc Sayı
                  return 'Xərc Sayı (Neçə Dəfə): ' + dataValue + ' dəfə';
                }
              }
            }
          }
        },
        animation: {
          duration: 1200, // Animasiya müddəti (1.2 saniyə)
          easing: 'easeInOutQuad', // Animasiya effekti
        },
        layout: {
          padding: {
            top: 10, // Yuxarı boşluq
            right: 10, // Sağ boşluq
            bottom: 10, // Aşağı boşluq
            left: 10 // Sol boşluq
          }
        }
      }
    });

  } catch (error) {
    console.error('Veri alınarkən xəta baş verdi:', error);
    const expenseTableBody = document.querySelector('#expenseTable tbody');
    const row = document.createElement('tr');
    row.innerHTML = `<td colspan="5">Veri alınarkən xəta baş verdi. Zəhmət olmasa təkrar cəhd edin.</td>`;
    expenseTableBody.appendChild(row);
  }
}

// Harcama tablosu güncellendikten sonra grafiği güncelle
updateExpenseStatistics();

document.addEventListener('DOMContentLoaded', () => {
  updateExpenseTable();
  updateExpenseStatistics();
});

// Excel ixrac et
document.getElementById('exportBtn').addEventListener('click', () => {
  const expensesRef = ref(db, 'expenses/' + localStorage.getItem('username'));
  get(expensesRef).then(snapshot => {
    const expenses = snapshot.val();

    if (!expenses) {
      showErrorModal('Məlumat tapılmadı.');
      return;
    }

    const data = Object.values(expenses).map(expense => ({
      Kateqoriya: expense.category,
      Miqdar: expense.amount,
      Təsvir: expense.description,
      Məbləğ: expense.currency,
      Tarix: new Date(expense.date).toLocaleString('az-AZ', {
        timeZone: 'Asia/Baku',
        day: '2-digit',
        month: '2-digit',
        year: 'numeric'
      })
    }));

    // Veriyi Excel sayfasına dönüştür
    const ws = XLSX.utils.json_to_sheet(data);

    // Başlıqları stilizə et
    const headerStyle = {
      fill: { fgColor: { rgb: "0000FF" } },  // Mavi rəng
      font: { color: { rgb: "FFFFFF" }, bold: true }  // Ağ yazı və qalın yazı
    };

    // Başlıq hüceyrələrinə stil tətbiq edirik (A1, B1, C1, D1, E1 hüceyrələri)
    const headers = ['A1', 'B1', 'C1', 'D1', 'E1'];  // Başlıq hüceyrələrinin ünvanları
    headers.forEach(cell => {
      if (ws[cell]) {
        ws[cell].s = headerStyle;  // Başlıq hücresine stil tətbiq edirik
      }
    });
    // Excel sayfasını oluştur
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Xərc Məlumatları");

    // Dosyayı dışa aktar
    XLSX.writeFile(wb, "xərc-hesabatı.xlsx");
  }).catch(error => {
    showErrorModal('Məlumat tapılmadı: ' + error.message);
    console.error('Məlumat tapılmadı:', error);
  });
});



// Excel faylını daxilə atama
document.getElementById('importBtn').addEventListener('click', () => {
  document.getElementById('fileInput').click();
});

// Fayl daxilə seçildiyində əməliyyat icra olunur
document.getElementById('fileInput').addEventListener('change', (event) => {
  const file = event.target.files[0];

  if (file) {
    const reader = new FileReader();
    reader.onload = async function (e) {
      const data = e.target.result;

      try {
        // Excel faylı oxunur
        const workbook = XLSX.read(data, { type: 'binary' });

        // İlk səhifə oxunur
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];

        // Səhifədəki malumatlar JSON formatına çevirilir
        const jsonData = XLSX.utils.sheet_to_json(worksheet);

        // Firebaseyə məlumat ötürülür
        const username = localStorage.getItem('username');
        const expensesRef = ref(db, 'expenses/' + username);

        // Əvvəkli məlumatlar silinir
        await remove(expensesRef);

        // Yeni məlumatlar Firebase ötürülür
        jsonData.forEach(row => {
          const { Kateqoriya, Miqdar, Təsvir, Məbləğ, Tarix } = row;

          // Məlumatları Fİrebase saxlayır
          push(expensesRef, {
            category: Kateqoriya,
            amount: Miqdar,
            description: Təsvir,
            currency: Məbləğ,
            date: new Date(Tarix).toISOString()
          });
        });

        // Cədvəl güncəllənir
        updateExpenseTable();
        showNotificationModal('Məlumat daxil edildi!');
      } catch (error) {
        console.error('Hata:', error);
        showErrorModal('Məlumat içəri axtarılarkən xəta.');
      }
    };

    reader.readAsBinaryString(file);
  }
});
const dragDropArea = document.getElementById("drag-drop-area");
const fileInput = document.getElementById("fileInput");
const importBtn = document.getElementById("importBtn");

dragDropArea.addEventListener("click", () => {
  fileInput.click();
});

dragDropArea.addEventListener("dragover", (event) => {
  event.preventDefault();
  dragDropArea.classList.add("dragover");
});

dragDropArea.addEventListener("dragleave", () => {
  dragDropArea.classList.remove("dragover");
});

dragDropArea.addEventListener("drop", (event) => {
  event.preventDefault();
  dragDropArea.classList.remove("dragover");

  const file = event.dataTransfer.files[0];
  handleFileUpload(file);
});

fileInput.addEventListener("change", (event) => {
  const file = event.target.files[0];
  handleFileUpload(file);
});

function handleFileUpload(file) {
  if (file && (file.name.endsWith(".xlsx") || file.name.endsWith(".xls"))) {
    dragDropArea.classList.remove("error");
    dragDropArea.classList.add("success");
    importBtn.disabled = false; // Enable the "Import" button when a valid file is selected
    showNotificationModal(`Fayl "${file.name}" uğurla yükləndi!`);
  } else {
    dragDropArea.classList.remove("success");
    dragDropArea.classList.add("error");
    importBtn.disabled = true; // Disable the "Import" button if the file is invalid
    showErrorModal("Zəhmət olmasa doğru Excel faylı yükləyin (.xlsx və ya .xls).");
  }
}


// Dark Light
const darklightButton = document.getElementById('darklightButton');
const darkIcon = document.querySelector('.darkicon');
const lightIcon = document.querySelector('.lighticon');

// Sayfa yüklendiğinde koyu modun aktif olup olmadığını kontrol et
if (document.body.classList.contains('dark-mode')) {
  darkIcon.style.display = 'none';
  lightIcon.style.display = 'inline';
} else {
  darkIcon.style.display = 'inline';
  lightIcon.style.display = 'none';
}

darklightButton.addEventListener('click', () => {
  document.body.classList.toggle('dark-mode');
  if (document.body.classList.contains('dark-mode')) {
    // Koyu moddayken ikonları değiştir
    darkIcon.style.display = 'none';  // Koyu ikonları gizle
    lightIcon.style.display = 'inline';  // Aydınlık ikonları göster
  } else {
    // Aydınlık moddayken ikonları değiştir
    darkIcon.style.display = 'inline';  // Koyu ikonları göster
    lightIcon.style.display = 'none';  // Aydınlık ikonları gizle
  }
});




const openCloseButton = document.getElementById("openCloseArrow")
openCloseButton.addEventListener('click', function () {
  const hiddenTxt = document.querySelectorAll('#sideTabs .hiddenTxt')
  const sideBar = document.getElementById("header");
  const isMobile = window.innerWidth <= 768;
  const profilIcon = document.getElementById('profile-icon')
  const profileBio = document.getElementById("profile-bio")
  const logoutLabel = document.getElementById("logoutLbl")
  // Mobile
  if (isMobile) {
    if (sideBar.style.height === "20vw") {
      sideBar.style.height = "10vw";
      profilIcon.style.width = "10vw";
      openCloseButton.style.transform = "rotate(180deg)";
    }
    else {
      sideBar.style.height = "20vw";
      openCloseButton.style.transform = "rotate(0deg)";
    }
  }
  // PC
  else {
    if (sideBar.style.width === "15%") {
      sideBar.style.width = "5%";
      profilIcon.style.width = '60px';
      openCloseButton.style.transform = "rotate(180deg)";
      hiddenTxt.forEach((p) => {
        p.style.display = 'none';
      });
      profileBio.style.fontSize = "16px"
      logoutLabel.style.display = 'none'
      document.getElementById('addAmount').style.display = 'none'
      document.getElementById('addBalanceBtn').style.display = 'none'
    }
    else {
      sideBar.style.width = "15%";
      profilIcon.style.width = '80px';
      openCloseButton.style.transform = "rotate(0deg)";
      hiddenTxt.forEach((p) => {
        p.style.display = 'block';
      });
      profileBio.style.fontSize = "20px"
      logoutLabel.style.display = 'block'
      document.getElementById('addAmount').style.display = 'flex'
      document.getElementById('addBalanceBtn').style.display = 'flex'
    }
  }
})

document.querySelectorAll('.tabLink').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();

    document.querySelector(this.getAttribute('href')).scrollIntoView({
      behavior: 'smooth'
    });
  });
});

// document.addEventListener("keydown", function(e) {
//   if (e.key === "F12" || (e.ctrlKey && e.shiftKey && e.key === "I")) {
//       e.preventDefault();
//   }
// });

// document.addEventListener("contextmenu", function(e) {
//   e.preventDefault();
// });

// API URL və açar
const apiUrl = 'https://v6.exchangerate-api.com/v6/a3d0a854732615cec4660353/latest/USD';

// Valyuta məzənnələrini çəkmək funksiyası
function getExchangeRates() {
  fetch(apiUrl)
    .then(response => response.json())
    .then(data => {
      // API-dən gələn verilərlə DOM-u yeniləmə
      document.getElementById('azn').textContent = data.conversion_rates.AZN.toFixed(2);
      document.getElementById('usd').textContent = data.conversion_rates.USD.toFixed(2);
      document.getElementById('rub').textContent = data.conversion_rates.RUB.toFixed(2);
    })
    .catch(error => {
      console.error('API xətası:', error);
    });
}

// İlk veriləri yüklə
getExchangeRates();

// Hər 8 saata bir valyuta məzənnələrini yenilə
setInterval(getExchangeRates, 8 * 60 * 60 * 1000); // 8 saat = 8 * 60 * 60 * 1000 ms

// Xəta modalını göstərmək
function showErrorModal(message) {
  const modal = document.getElementById('errorModal');
  const errorMessage = document.getElementById('errorMessage');

  // Xəta mesajını təyin et
  errorMessage.textContent = message;

  // Modalı görünür et və animasiya ilə göstər
  modal.style.display = 'block';
  setTimeout(() => modal.style.opacity = 1, 10);

  // 2 saniyə sonra animasiya ilə yox olmasını təmin et
  setTimeout(() => {
    modal.style.opacity = 0;
    setTimeout(() => modal.style.display = 'none', 500); // Animasiya bitdikdən sonra gizlət
  }, 2000); // 2 saniyə sonra yox ol
}

// Bildiriş modalını göstərmək
function showNotificationModal(message) {
  const modal = document.getElementById('notificationModal');
  const notificationMessage = document.getElementById('notificationMessage');

  // Bildiriş mesajını təyin et
  notificationMessage.textContent = message;

  // Modalı görünür et və animasiya ilə göstər
  modal.style.display = 'block';
  setTimeout(() => modal.style.opacity = 1, 10);

  // 2 saniyə sonra animasiya ilə yox olmasını təmin et
  setTimeout(() => {
    modal.style.opacity = 0;
    setTimeout(() => modal.style.display = 'none', 500); // Animasiya bitdikdən sonra gizlət
  }, 2000); // 2 saniyə sonra yox ol
}
    </script>
  </body>
</html>
